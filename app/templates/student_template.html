<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Schüler-Vertretungen</title>
    <style>
      body {
        margin: 0;
        font-family: sans-serif;
      }
      #table-container {
        height: calc(100vh - 10vh);
        overflow-y: auto;
        padding: 10px;
        padding-bottom: 20vh;
      }
      table {
        width: 95%;
        border-collapse: collapse;
        font-size: 1.5vw;
        margin: 0 auto;
      }
      th,
      td {
        border: 1px solid #333;
        padding: 8px;
        text-align: center;
      }
      th {
        background: #0066cc;
        color: #fff;
      }
      tbody tr:nth-child(odd) {
        background-color: #ffffff; /* weiß */
      }
      tbody tr:nth-child(even) {
        background-color: #00aeff; /* hellgrau */
      }
      #banner {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 10vh;
        border-top: 1px solid #444;
        padding: 8px;
        background: #e0e0e0;
        font-size: 8vh;
        line-height: 10vh;
        text-align: center;
        color: red;
        overflow: hidden;
        white-space: nowrap;
      }
      .signature {
        text-align: right;
        font-size: 1vw;
        color: #666;
        margin-top: 1em;
      }
      .footer-spacer {
        height: 14vh;
      }
    </style>
  </head>
  <body>
    <div id="table-container">
      <div class="footer-spacer"></div>
      <h2>Vertretungen am {{ today }}</h2>
      <table>
        <tr>
          <th>Klasse</th>
          <th>Stunde</th>
          <th>Raum</th>
          <th>Fach</th>
          <th>Lehrer</th>
        </tr>
        {% for kl, periods in data.items() %} {% for p in periods %}
        <tr>
          <td>{{ kl }}</td>
          <td>{{ p.start }}–{{ p.end }}</td>
          <td>{{ p.rooms|join(", ") }}</td>
          <td>{{ p.subjects|join(", ") }}</td>
          <td>{{ p.teachers|join(", ") }}</td>
        </tr>
        {% endfor %} {% endfor %}
      </table>
      <div class="signature">@Nargang</div>
      <div class="footer-spacer"></div>
    </div>

    <div id="banner">
      {% if banner.mode=='text' %}{{ banner.text }}{% endif %}
    </div>

    <script>
      const container = document.getElementById("table-container");
      const step = 0.5;
      const speed = 50;
      const refreshPerView = 20;
      container.scrollTop = 0;

      const ratio = container.scrollHeight / container.clientHeight;
      const reloadTime = ratio * refreshPerView * 1000;

      const scroller = setInterval(() => {
        container.scrollBy(0, step);
      }, speed);

      setTimeout(() => {
        clearInterval(scroller);
        window.location.reload();
      }, reloadTime);
    </script>
  </body>
</html>
